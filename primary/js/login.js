(function(){var G={maxLen:12,authURL:'/LoginCheck',langURL:'/goform/setLang',herf:'login.asp',mainPage:'main.asp',failPage:'login.asp?0',usersfullPage:'login.asp?1'},MSG={pwdError:_("Password error!"),capLock:_("The Caps Lock key has been locked!"),empty:_("Password can not be empty!"),lenError:_("Password can not exceed 12 characters in length!"),usersfullError:_("Login forbid,users full!")},encode=(function(){return function(s){return base64encode(utf16to8(s))}})();function handlePwdError(){var pathname_arr=window.location.toString().split("?");$("#msg").html('&nbsp;').hide();login_status=pathname_arr[1];if(login_status==0){$("#msg").html(MSG.pwdError).show()}else if(login_status==1){$("#msg").html(MSG.usersfullError).show()}}function initView(){if(location.href!=top.location.href){top.location.href=G.herf}handlePwdError();$("#password").val('');$("#password").focus()}function enterDown(events){var e=events||window.event,char_code=e.charCode||e.keyCode;if(char_code==13){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}submitForm()}}function setLang(lang){var lang="lang="+lang;$.post(G.langURL,lang,function(msg){window.location.reload(true)})}function validateData(){var pwd=$('#password').val();$("#msg").html('&nbsp;').hide();if(""==pwd){$("#msg").html(MSG.empty).show();$('#password').focus();return false}if(pwd.length>G.maxLen){$("#msg").html(MSG.lenError).show();$('#password').focus();return false}return true}function submitForm(){if(validateData()){var data='Password='+encode($('#password').val());$.post(G.authURL,data,function(msg){if("0"==msg){window.location.href=G.failPage}else if("1"==msg){window.location.href=G.usersfullPage}else{window.location.href=G.mainPage}})}}function detectCapsLock(event){var e=event||window.event,keyCode=e.keyCode||e.which;isShift=e.shiftKey||(keyCode==16);$("#msg").html('&nbsp;').hide();;if(((keyCode>=65&&keyCode<=90)&&!isShift)||((keyCode>=97&&keyCode<=122)&&isShift)){$("#msg").html(MSG.capLock).show();}}function initEvent(){$(document).on('keydown',enterDown);$('#password').on('keypress',detectCapsLock);$("#country .addLang").on("click",function(){var node=$("#country .dropdown-menu");if(node.is(":hidden")){node.show()}else{node.hide()}});$("#country .dropdown-menu li").on("click",function(){var lang=$(this).attr("data-val");$("#country").attr("data-val",lang);$("#country .dropdown-menu").hide();$("#country .lang").html(B.langArr[lang]);setLang(lang)});$('#submit').on('click',submitForm);$("#cancel").on("click",function(){$("#password").val('')})}function initHtml(){var supportLang=B.options.support,len=supportLang.length,str,i=0;str="<div class='dropdown'>";str+="<div class='addLang'>";str+="<span class='lang'>"+B.langArr[B.lang]+"</span>";str+="<span class='caret'></span>";str+="</div>";str+="<ul class='dropdown-menu'>";for(i=0;i<len;i+=1){lang=supportLang[i];str+="<li data-val='"+lang+"'><a>"+B.langArr[lang]+"</a></li>"}str+="</ul>";str+="</div>";$("#country").html(str);$("#country").attr("data-val",B.lang)};function init(){initHtml();initView();initEvent()}$(function(){init()})})();